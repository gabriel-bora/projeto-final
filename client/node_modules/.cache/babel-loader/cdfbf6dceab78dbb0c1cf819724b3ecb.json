{"ast":null,"code":"'use strict';\n\nvar constants = require('./constants');\nvar CrcStream = require('./crc');\nvar bitPacker = require('./bitpacker');\nvar filter = require('./filter-pack');\nvar zlib = require('zlib');\nvar Packer = module.exports = function (options) {\n  this._options = options;\n  options.deflateChunkSize = options.deflateChunkSize || 32 * 1024;\n  options.deflateLevel = options.deflateLevel != null ? options.deflateLevel : 9;\n  options.deflateStrategy = options.deflateStrategy != null ? options.deflateStrategy : 3;\n  options.inputHasAlpha = options.inputHasAlpha != null ? options.inputHasAlpha : true;\n  options.deflateFactory = options.deflateFactory || zlib.createDeflate;\n  options.bitDepth = options.bitDepth || 8;\n  // This is outputColorType\n  options.colorType = typeof options.colorType === 'number' ? options.colorType : constants.COLORTYPE_COLOR_ALPHA;\n  options.inputColorType = typeof options.inputColorType === 'number' ? options.inputColorType : constants.COLORTYPE_COLOR_ALPHA;\n  if ([constants.COLORTYPE_GRAYSCALE, constants.COLORTYPE_COLOR, constants.COLORTYPE_COLOR_ALPHA, constants.COLORTYPE_ALPHA].indexOf(options.colorType) === -1) {\n    throw new Error('option color type:' + options.colorType + ' is not supported at present');\n  }\n  if ([constants.COLORTYPE_GRAYSCALE, constants.COLORTYPE_COLOR, constants.COLORTYPE_COLOR_ALPHA, constants.COLORTYPE_ALPHA].indexOf(options.inputColorType) === -1) {\n    throw new Error('option input color type:' + options.inputColorType + ' is not supported at present');\n  }\n  if (options.bitDepth !== 8 && options.bitDepth !== 16) {\n    throw new Error('option bit depth:' + options.bitDepth + ' is not supported at present');\n  }\n};\nPacker.prototype.getDeflateOptions = function () {\n  return {\n    chunkSize: this._options.deflateChunkSize,\n    level: this._options.deflateLevel,\n    strategy: this._options.deflateStrategy\n  };\n};\nPacker.prototype.createDeflate = function () {\n  return this._options.deflateFactory(this.getDeflateOptions());\n};\nPacker.prototype.filterData = function (data, width, height) {\n  // convert to correct format for filtering (e.g. right bpp and bit depth)\n  var packedData = bitPacker(data, width, height, this._options);\n\n  // filter pixel data\n  var bpp = constants.COLORTYPE_TO_BPP_MAP[this._options.colorType];\n  var filteredData = filter(packedData, width, height, this._options, bpp);\n  return filteredData;\n};\nPacker.prototype._packChunk = function (type, data) {\n  var len = data ? data.length : 0;\n  var buf = new Buffer(len + 12);\n  buf.writeUInt32BE(len, 0);\n  buf.writeUInt32BE(type, 4);\n  if (data) {\n    data.copy(buf, 8);\n  }\n  buf.writeInt32BE(CrcStream.crc32(buf.slice(4, buf.length - 4)), buf.length - 4);\n  return buf;\n};\nPacker.prototype.packGAMA = function (gamma) {\n  var buf = new Buffer(4);\n  buf.writeUInt32BE(Math.floor(gamma * constants.GAMMA_DIVISION), 0);\n  return this._packChunk(constants.TYPE_gAMA, buf);\n};\nPacker.prototype.packIHDR = function (width, height) {\n  var buf = new Buffer(13);\n  buf.writeUInt32BE(width, 0);\n  buf.writeUInt32BE(height, 4);\n  buf[8] = this._options.bitDepth; // Bit depth\n  buf[9] = this._options.colorType; // colorType\n  buf[10] = 0; // compression\n  buf[11] = 0; // filter\n  buf[12] = 0; // interlace\n\n  return this._packChunk(constants.TYPE_IHDR, buf);\n};\nPacker.prototype.packIDAT = function (data) {\n  return this._packChunk(constants.TYPE_IDAT, data);\n};\nPacker.prototype.packIEND = function () {\n  return this._packChunk(constants.TYPE_IEND, null);\n};","map":{"version":3,"names":["constants","require","CrcStream","bitPacker","filter","zlib","Packer","module","exports","options","_options","deflateChunkSize","deflateLevel","deflateStrategy","inputHasAlpha","deflateFactory","createDeflate","bitDepth","colorType","COLORTYPE_COLOR_ALPHA","inputColorType","COLORTYPE_GRAYSCALE","COLORTYPE_COLOR","COLORTYPE_ALPHA","indexOf","Error","prototype","getDeflateOptions","chunkSize","level","strategy","filterData","data","width","height","packedData","bpp","COLORTYPE_TO_BPP_MAP","filteredData","_packChunk","type","len","length","buf","Buffer","writeUInt32BE","copy","writeInt32BE","crc32","slice","packGAMA","gamma","Math","floor","GAMMA_DIVISION","TYPE_gAMA","packIHDR","TYPE_IHDR","packIDAT","TYPE_IDAT","packIEND","TYPE_IEND"],"sources":["D:/Documents/QQTech/projeto-final/client/node_modules/pngjs/lib/packer.js"],"sourcesContent":["'use strict';\n\nvar constants = require('./constants');\nvar CrcStream = require('./crc');\nvar bitPacker = require('./bitpacker');\nvar filter = require('./filter-pack');\nvar zlib = require('zlib');\n\nvar Packer = module.exports = function(options) {\n  this._options = options;\n\n  options.deflateChunkSize = options.deflateChunkSize || 32 * 1024;\n  options.deflateLevel = options.deflateLevel != null ? options.deflateLevel : 9;\n  options.deflateStrategy = options.deflateStrategy != null ? options.deflateStrategy : 3;\n  options.inputHasAlpha = options.inputHasAlpha != null ? options.inputHasAlpha : true;\n  options.deflateFactory = options.deflateFactory || zlib.createDeflate;\n  options.bitDepth = options.bitDepth || 8;\n  // This is outputColorType\n  options.colorType = (typeof options.colorType === 'number') ? options.colorType : constants.COLORTYPE_COLOR_ALPHA;\n  options.inputColorType = (typeof options.inputColorType === 'number') ? options.inputColorType : constants.COLORTYPE_COLOR_ALPHA;\n\n  if ([\n    constants.COLORTYPE_GRAYSCALE,\n    constants.COLORTYPE_COLOR,\n    constants.COLORTYPE_COLOR_ALPHA,\n    constants.COLORTYPE_ALPHA\n  ].indexOf(options.colorType) === -1) {\n    throw new Error('option color type:' + options.colorType + ' is not supported at present');\n  }\n  if ([\n    constants.COLORTYPE_GRAYSCALE,\n    constants.COLORTYPE_COLOR,\n    constants.COLORTYPE_COLOR_ALPHA,\n    constants.COLORTYPE_ALPHA\n  ].indexOf(options.inputColorType) === -1) {\n    throw new Error('option input color type:' + options.inputColorType + ' is not supported at present');\n  }\n  if (options.bitDepth !== 8 && options.bitDepth !== 16) {\n    throw new Error('option bit depth:' + options.bitDepth + ' is not supported at present');\n  }\n};\n\nPacker.prototype.getDeflateOptions = function() {\n  return {\n    chunkSize: this._options.deflateChunkSize,\n    level: this._options.deflateLevel,\n    strategy: this._options.deflateStrategy\n  };\n};\n\nPacker.prototype.createDeflate = function() {\n  return this._options.deflateFactory(this.getDeflateOptions());\n};\n\nPacker.prototype.filterData = function(data, width, height) {\n  // convert to correct format for filtering (e.g. right bpp and bit depth)\n  var packedData = bitPacker(data, width, height, this._options);\n\n  // filter pixel data\n  var bpp = constants.COLORTYPE_TO_BPP_MAP[this._options.colorType];\n  var filteredData = filter(packedData, width, height, this._options, bpp);\n  return filteredData;\n};\n\nPacker.prototype._packChunk = function(type, data) {\n\n  var len = (data ? data.length : 0);\n  var buf = new Buffer(len + 12);\n\n  buf.writeUInt32BE(len, 0);\n  buf.writeUInt32BE(type, 4);\n\n  if (data) {\n    data.copy(buf, 8);\n  }\n\n  buf.writeInt32BE(CrcStream.crc32(buf.slice(4, buf.length - 4)), buf.length - 4);\n  return buf;\n};\n\nPacker.prototype.packGAMA = function(gamma) {\n  var buf = new Buffer(4);\n  buf.writeUInt32BE(Math.floor(gamma * constants.GAMMA_DIVISION), 0);\n  return this._packChunk(constants.TYPE_gAMA, buf);\n};\n\nPacker.prototype.packIHDR = function(width, height) {\n\n  var buf = new Buffer(13);\n  buf.writeUInt32BE(width, 0);\n  buf.writeUInt32BE(height, 4);\n  buf[8] = this._options.bitDepth; // Bit depth\n  buf[9] = this._options.colorType; // colorType\n  buf[10] = 0; // compression\n  buf[11] = 0; // filter\n  buf[12] = 0; // interlace\n\n  return this._packChunk(constants.TYPE_IHDR, buf);\n};\n\nPacker.prototype.packIDAT = function(data) {\n  return this._packChunk(constants.TYPE_IDAT, data);\n};\n\nPacker.prototype.packIEND = function() {\n  return this._packChunk(constants.TYPE_IEND, null);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}